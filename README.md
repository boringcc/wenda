# 仿知乎问答系统

## 项目描述

仿照知乎的构造和部分功能的问答网站，具有下列的功能：**登录注册，用户发表问题，评论，点赞，点踩，关注问题，关注其他用户，个人动态，关注的人的动态，问题的搜索**。



## 技术实现

JDK：jdk1.8

后台：SpringBoot + Mybatis 

前端：Bootstrap + Jquery   + JS + AJAX + Velocity

数据库：Mysql + Redis

项目构建工具：Maven

## 项目结构

**项目结构：**

**--java**

  **--com.cc.wenda**

​	**--aspect**：面向切面编程，主要存放了日志的切面类

​	**--async**：存放了异步框架的类，包括事件类型，事件处理类和Handler接口

​		**--handler**：handler接口的实现类

​	**--configuration**：主要存放Springboot配置拦截器的类

​	**--controller**：传统mvc的控制器层，处理与前端的用户交互问题

​	**--dao**：Dao层，处理数据库数据交互问题

​	**--interceptor**：拦截器包，存放拦截器类

​	**--model**：传统mvc的实体层，存放实体类

 	**--service**：服务层

 	**--util**：工具包，存放各种工具类

**--resources**

​    **--mapper**：存放mybatis的mapper.xml文件

​    **--static**：静态文件，js，css，图片等

​    **--templates**：Velocity的模板，也就是html。

**--test**：测试

## 关键技术

### 登录/注册

- 1.登录时cookie中加上一个ticket用来实现登录后的页面免登录。
- 2.用拦截器来验证用户是否登录来判断用户是否能访问该页面。
- 3.注册时密码使用md5加密，存入数据库。
- 4.注册时发送验证码到注册邮箱，然后填写验证码才能完成登录，并且验证码会超时。

### 敏感词过滤

主要通过建造一颗敏感词的前缀树，然后通过类似字符串匹配的算法将敏感词替换成***。

### 异步框架

作用：异步处理添加问题、关注事件、点赞事件、更新feed流、推送feed、添加个人动态增加solr的索引等

实现原理：类似生产者消费者模式，有producer将各种事件加入到redis的队列中，然后又consumer类将各种handler处理类与对应的事件类型关联起来，在线程中调用handler的处理方法去处理各种事件。

### java邮件发送

发送一些简单的邮件，采用的是JavaMailSenderImpl类来完成邮件的发送的。

其中邮件的自定义内容是用的Velocity的html模板填充内容得到的。

### 问题和评论的排序算法（即评分）

采用StackOverflow算法来得到每个问题或评论的分数，当用户访问该问题页面时，会按照分数来进行排序，可以根据不同的需求修改算法中某些项的权重达到目的。比如浏览量多的排前面就加大浏览量相乘的参数等。

### TimeLine的简单实现

分别实现了推模式和拉模式。

推模式：当用户产生新的事件时，推送到关注者的TimeLine中。

拉模式：直接获取关注的人的最新事件。

### Solr搜索

加入中文分词器IK-Anayzer，在加入问题的时候自动将标题和内容建立相对应的索引，搜索出来的内容按照分数进行排序并且关键字标红。

### Redis

用jedis来实现redis的一些基础操作，主要用来存储页面访问量，点赞事件的信息和关注事件的信息还有feed流推送的信息等

### Ajax异步加载内容

在页面底部点击更多按钮会无刷新的添加新的内容。























